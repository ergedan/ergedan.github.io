<!DOCTYPE HTML>
<html lang="zh-CN">


<head>
    <meta charset="utf-8">
    <meta name="keywords" content="Apache分析和日志管理工具, Joah">
    <meta name="description" content="一、cronologcronolog 是一个简单的过滤程序，读取日志文件条目从标准输入和输出的每个条目并写入指定的日志文件的文件名模板和当前的日期和时间。cronolog 旨在和一个Web服务器一起使用，如Apache，分割访问日志为每天或">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="renderer" content="webkit|ie-stand|ie-comp">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="format-detection" content="telephone=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <title>Apache分析和日志管理工具 | Joah</title>
    <link rel="icon" type="image/png" href="/favicon.png">

    <link rel="stylesheet" type="text/css" href="/libs/awesome/css/font-awesome.min.css">
    <link rel="stylesheet" type="text/css" href="/libs/materialize/css/materialize.min.css">
    <link rel="stylesheet" type="text/css" href="/libs/aos/aos.css">
    <link rel="stylesheet" type="text/css" href="/libs/animate/animate.min.css">
    <link rel="stylesheet" type="text/css" href="/libs/lightGallery/css/lightgallery.min.css">
    <link rel="stylesheet" type="text/css" href="/css/matery.css">
    <link rel="stylesheet" type="text/css" href="/css/my.css">

    <script src="/libs/jquery/jquery-2.2.0.min.js"></script>
<link rel="stylesheet" href="/css/prism-tomorrow.css" type="text/css"></head>


<body>

<header class="navbar-fixed">
    <nav id="headNav" class="bg-color nav-transparent">
        <div id="navContainer" class="container">
            <div class="nav-wrapper">
                <div class="brand-logo">
                    <a href="/" class="waves-effect waves-light">
                        
                        <img src="/medias/logo.jpg" class="logo-img hide-on-small-only">
                        
                        <span class="logo-span">Joah</span>
                    </a>
                </div>
                

<a href="#" data-activates="mobile-nav" class="button-collapse"><i class="fa fa-navicon"></i></a>
<ul class="right">
    
    <li class="hide-on-med-and-down">
        <a href="/" class="waves-effect waves-light">
            
            <i class="fa fa-home"></i>
            
            <span>首页</span>
        </a>
    </li>
    
    <li class="hide-on-med-and-down">
        <a href="/tags" class="waves-effect waves-light">
            
            <i class="fa fa-tags"></i>
            
            <span>标签</span>
        </a>
    </li>
    
    <li class="hide-on-med-and-down">
        <a href="/categories" class="waves-effect waves-light">
            
            <i class="fa fa-bookmark"></i>
            
            <span>分类</span>
        </a>
    </li>
    
    <li class="hide-on-med-and-down">
        <a href="/archives" class="waves-effect waves-light">
            
            <i class="fa fa-archive"></i>
            
            <span>归档</span>
        </a>
    </li>
    
    <li class="hide-on-med-and-down">
        <a href="/about" class="waves-effect waves-light">
            
            <i class="fa fa-user-circle-o"></i>
            
            <span>关于</span>
        </a>
    </li>
    
    <li class="hide-on-med-and-down">
        <a href="/friends" class="waves-effect waves-light">
            
            <i class="fa fa-address-book"></i>
            
            <span>友情链接</span>
        </a>
    </li>
    
    <li>
        <a id="toggleSearch" class="waves-effect waves-light">
            <i id="searchIcon" class="mdi-action-search" title="搜索"></i>
        </a>
    </li>

</ul>

<div class="side-nav" id="mobile-nav">

    <div class="mobile-head bg-color">
        
        <img src="/medias/logo.jpg" class="logo-img circle responsive-img">
        
        <div class="logo-name">Joah</div>
        <div class="logo-desc">
            
            嘿，终于等到你来了。
            
        </div>
    </div>

    

    <ul class="menu-list mobile-menu-list">
        
        <li>
            <a href="/" class="waves-effect waves-light">
                
                <i class="fa fa-fw fa-home"></i>
                
                首页
            </a>
        </li>
        
        <li>
            <a href="/tags" class="waves-effect waves-light">
                
                <i class="fa fa-fw fa-tags"></i>
                
                标签
            </a>
        </li>
        
        <li>
            <a href="/categories" class="waves-effect waves-light">
                
                <i class="fa fa-fw fa-bookmark"></i>
                
                分类
            </a>
        </li>
        
        <li>
            <a href="/archives" class="waves-effect waves-light">
                
                <i class="fa fa-fw fa-archive"></i>
                
                归档
            </a>
        </li>
        
        <li>
            <a href="/about" class="waves-effect waves-light">
                
                <i class="fa fa-fw fa-user-circle-o"></i>
                
                关于
            </a>
        </li>
        
        <li>
            <a href="/friends" class="waves-effect waves-light">
                
                <i class="fa fa-fw fa-address-book"></i>
                
                友情链接
            </a>
        </li>
        
        
        <li><div class="divider"></div></li>
        <li>
            <a href="https://github.com/ergedan/" class="waves-effect waves-light" target="_blank">
                <i class="fa fa-github-square fa-fw"></i>fork me
            </a>
        </li>
        
    </ul>

    <div class="social-link">
    <a href="https://github.com/ergedan/" class="tooltipped" target="_blank" data-tooltip="访问我的GitHub" data-position="top" data-delay="50">
        <i class="fa fa-github"></i>
    </a>



    <a href="mailto:473823554@qq.com" class="tooltipped" target="_blank" data-tooltip="邮件联系我" data-position="top" data-delay="50">
        <i class="fa fa-envelope-open"></i>
    </a>



    <a href="tencent://AddContact/?fromId=50&fromSubId=1&subcmd=all&uin=473823554" class="tooltipped" data-tooltip="QQ联系我: 473823554" data-position="top" data-delay="50">
        <i class="fa fa-qq"></i>
    </a>



    <a href="/atom.xml" class="tooltipped" target="_blank" data-tooltip="RSS 订阅" data-position="top" data-delay="50">
        <i class="fa fa-rss"></i>
    </a>
</div>
</div>

            </div>
        </div>

        
        <style>
    .nav-transparent .github-corner {
        display: none !important;
    }

    .github-corner {
        position: absolute;
        z-index: 10;
        top: 0;
        right: 0;
        border: 0;
        transform: scale(1.1);
    }

    .github-corner svg {
        color: #0f9d58;
        fill: #fff;
        height: 64px;
        width: 64px;
    }

    .github-corner:hover .octo-arm {
        animation: a 0.56s ease-in-out;
    }

    .github-corner .octo-arm {
        animation: none;
    }

    @keyframes a {
        0%,
        to {
            transform: rotate(0);
        }
        20%,
        60% {
            transform: rotate(-25deg);
        }
        40%,
        80% {
            transform: rotate(10deg);
        }
    }
</style>

<a href="https://github.com/ergedan/" class="github-corner tooltipped hide-on-med-and-down" target="_blank"
   data-tooltip="fork me" data-position="left" data-delay="50">
    <svg viewBox="0 0 250 250" aria-hidden="true">
        <path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path>
        <path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2"
              fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path>
        <path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z"
              fill="currentColor" class="octo-body"></path>
    </svg>
</a>
        
    </nav>
</header>





<div class="bg-cover post-cover" style="background-image: url('/medias/featureimages/21.jpg')">
    <div class="container">
        <div class="row">
            <div class="col s12 m12 l12">
                <div class="brand">
                    <div class="description center-align post-title">
                        Apache分析和日志管理工具
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>



<main class="container content">

    
    <!-- 文章内容详情 -->
<div id="artDetail">
    <div class="card">
        <div class="card-content article-info">
            <div class="row tag-cate">
                <div class="col s7">
                    
                    <div class="article-tag">
                        
                            <a href="/tags/cronlog/" target="_blank">
                                <span class="chip bg-color">cronlog</span>
                            </a>
                        
                            <a href="/tags/AWstat/" target="_blank">
                                <span class="chip bg-color">AWstat</span>
                            </a>
                        
                    </div>
                    
                </div>
                <div class="col s5 right-align">
                    
                    <div class="post-cate">
                        <i class="fa fa-bookmark fa-fw icon-category"></i>
                        
                            <a href="/categories/常用服务/" class="post-category" target="_blank">
                                常用服务
                            </a>
                        
                    </div>
                    
                </div>
            </div>

            <div class="post-info">
                <div class="post-date info-break-policy">
                    <i class="fa fa-calendar-minus-o fa-fw"></i>发布日期:&nbsp;&nbsp;
                    2017-11-28
                </div>

                
                    
                    <div class="info-break-policy">
                        <i class="fa fa-file-word-o fa-fw"></i>文章字数:&nbsp;&nbsp;
                        2,722
                    </div>
                    

                    
                    <div class="info-break-policy">
                        <i class="fa fa-clock-o fa-fw"></i>阅读时长:&nbsp;&nbsp;
                        13 分
                    </div>
                    
                
				
				
                    <div id="busuanzi_container_page_pv" class="info-break-policy">
                        <i class="fa fa-eye fa-fw"></i>阅读次数:&nbsp;&nbsp;
                        <span id="busuanzi_value_page_pv"></span>
                    </div>
				
            </div>
        </div>
        <hr class="clearfix">
        <div class="card-content article-card-content">
            <div id="articleContent">
                <h1 id="一、cronolog"><a href="#一、cronolog" class="headerlink" title="一、cronolog"></a>一、cronolog</h1><p>cronolog 是一个简单的过滤程序，读取日志文件条目从标准输入和输出的每个条目并写入指定的日志文件的文件名模板和当前的日期和时间。cronolog 旨在和一个Web服务器一起使用，如Apache，分割访问日志为每天或每月的日志。</p>
<h2 id="1、cronolog特点"><a href="#1、cronolog特点" class="headerlink" title="1、cronolog特点"></a>1、cronolog特点</h2><p>cronolog主要和web服务器配置使用，特别是apache服务器；apache默认日志文件是不分割的，因此如果我们要查找某天的内容会浏览一个整体文件去寻找，显然降低了我们的工作效率。cronolog可以将日志文件按时间分隔，易于管理和分析。</p>
<p><a href="https://directory.fsf.org/wiki/Cronolog" target="_blank" rel="noopener">https://directory.fsf.org/wiki/Cronolog</a> 官网，不过点击下载跳转至别的页面了….</p>
<p><strong>注意：在进行日志前首先更新下系统时间，以免当我们分析日志时，日志记录的时间是错误的。</strong></p>
<p><code>[root@localhost~]#yum install -y ntpdate</code><br><code>[root@localhost~]#ntpdate 172.18.0.1</code>  #更新时间指令</p>
<h2 id="2、源码安装cronolog"><a href="#2、源码安装cronolog" class="headerlink" title="2、源码安装cronolog"></a>2、源码安装cronolog</h2><p>（1）编译前先准备好编译环境</p>
<p><code>[root@localhost/usr/local/src/cronolog-1.6.2]#yum groupinstall -y &quot;development tools&quot;</code></p>
<p>（2）编译安装</p>
<p><code>[root@localhost/usr/local/src/cronolog-1.6.2]#./configure</code></p>
<p><code>[root@localhost/usr/local/src/cronolog-1.6.2]#make &amp;&amp; make install</code></p>
<p><code>[root@localhost~]#which cronolog</code></p>
<pre><code>/usr/local/sbin/cronolog    #查看命令路径
</code></pre><h2 id="3、cronolog命令"><a href="#3、cronolog命令" class="headerlink" title="3、cronolog命令"></a>3、cronolog命令</h2><p><code>[root@localhost~]#cronolog -h</code></p>
<p>格式：</p>
<pre><code>usage: cronolog [OPTIONS] logfile-spec
</code></pre><table>
<thead>
<tr>
<th>选项</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>-H NAME,   –hardlink=NAME</td>
<td>maintain a hard link from NAME to current log</td>
</tr>
<tr>
<td>-S NAME,   –symlink=NAME</td>
<td>maintain a symbolic link from NAME to current log</td>
</tr>
<tr>
<td>-P NAME,   –prev-symlink=NAME</td>
<td>maintain a symbolic link from NAME to previous log</td>
</tr>
<tr>
<td>-l NAME,   –link=NAME</td>
<td>same as -S/–symlink</td>
</tr>
<tr>
<td>-h,        –help</td>
<td>print this help, then exit</td>
</tr>
<tr>
<td>-p PERIOD, –period=PERIOD</td>
<td>set the rotation period explicitly</td>
</tr>
<tr>
<td>-d DELAY,  –delay=DELAY</td>
<td>set the rotation period delay</td>
</tr>
<tr>
<td>-o,        –once-only</td>
<td>create single output log from template (not rotated)</td>
</tr>
<tr>
<td>-x FILE,   –debug=FILE</td>
<td>write debug messages to FILE ( or to standard error if FILE is “-“)</td>
</tr>
<tr>
<td>-a,        –american</td>
<td>American date formats</td>
</tr>
<tr>
<td>-e,        –european</td>
<td>European date formats (default)</td>
</tr>
<tr>
<td>-s,    –start-time=TIME</td>
<td>starting time</td>
</tr>
<tr>
<td>-z TZ, –time-zone=TZ</td>
<td>use TZ for timezone</td>
</tr>
<tr>
<td>-V,      –version</td>
<td>print version number, then exit</td>
</tr>
</tbody>
</table>
<p><strong>注意：</strong><br><strong>cronolog一般采取管道的方式工作。</strong></p>
<h2 id="4、cronolog格式定义"><a href="#4、cronolog格式定义" class="headerlink" title="4、cronolog格式定义"></a>4、cronolog格式定义</h2><p>时间定义：</p>
<table>
<thead>
<tr>
<th>选项</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>H</td>
<td>小时（00..23）</td>
</tr>
<tr>
<td>I</td>
<td>小时(01..12)</td>
</tr>
<tr>
<td>p</td>
<td>该locale下的AM或PM标识</td>
</tr>
<tr>
<td>M</td>
<td>分钟(00..59)</td>
</tr>
<tr>
<td>S</td>
<td>秒 (00..61, which allows for leap seconds)</td>
</tr>
<tr>
<td>X</td>
<td>该locale下时间表示符(e.g.: “15:12:47”)</td>
</tr>
<tr>
<td>Z</td>
<td>时区。若时区不能确定，则无意义</td>
</tr>
<tr>
<td>a</td>
<td>该locale下的工作日简名(e.g.: Sun..Sat)</td>
</tr>
<tr>
<td>A</td>
<td>该locale下的工作日全名(e.g.: Sunday ..  Satur-ay)</td>
</tr>
<tr>
<td>b</td>
<td>该locale下的月份简称(e.g.: Jan .. Dec)</td>
</tr>
<tr>
<td>B</td>
<td>该locale下的月份全称(e.g.:  January .. December)</td>
</tr>
<tr>
<td>c</td>
<td>该locale下的日期和时间(e.g.: “Sun Dec 15  14:12:47 GMT 1996”)</td>
</tr>
<tr>
<td>d</td>
<td>当月中的天数 (01 .. 31)</td>
</tr>
<tr>
<td>j</td>
<td>当年中的天数 (001 .. 366)</td>
</tr>
<tr>
<td>m</td>
<td>月数 (01 .. 12)</td>
</tr>
<tr>
<td>U</td>
<td>当年中的星期数，以周日作为一周开始,其中第一周为首个含星期天的星期(00..53)</td>
</tr>
<tr>
<td>W</td>
<td>当年中的星期数，以星期一作为一周的开始,其中第一周为首个含星期天的星期(00..53)</td>
</tr>
<tr>
<td>w</td>
<td>工作日数(0 .. 6, 0表示星期天)</td>
</tr>
<tr>
<td>x</td>
<td>该locale下的日期表示(e.g. “13/04/97”)</td>
</tr>
<tr>
<td>y</td>
<td>两位数的年份(00 .. 99)</td>
</tr>
<tr>
<td>Y</td>
<td>四位数的年份(1970 .. 2038)</td>
</tr>
</tbody>
</table>
<h2 id="5、cronolog结合apache使用"><a href="#5、cronolog结合apache使用" class="headerlink" title="5、cronolog结合apache使用"></a>5、cronolog结合apache使用</h2><h3 id="编辑配置文件，也可以单独定义某个虚拟主机的日志"><a href="#编辑配置文件，也可以单独定义某个虚拟主机的日志" class="headerlink" title="编辑配置文件，也可以单独定义某个虚拟主机的日志"></a>编辑配置文件，也可以单独定义某个虚拟主机的日志</h3><p><code>[root@localhost~]#vim /etc/httpd/conf/httpd.conf</code> </p>
<p><img src="http://owatlfstl.bkt.clouddn.com/2017-10-25_184434.jpg" alt=""></p>
<h3 id="重启服务并测试"><a href="#重启服务并测试" class="headerlink" title="重启服务并测试"></a>重启服务并测试</h3><p><code>[root@localhost~]#ab -c 10 -n 1000 http://www.test.com/</code></p>
<h3 id="查看是否生成日志文件"><a href="#查看是否生成日志文件" class="headerlink" title="查看是否生成日志文件"></a>查看是否生成日志文件</h3><p><img src="http://owatlfstl.bkt.clouddn.com/2017-10-25_185010.jpg" alt=""></p>
<h1 id="二、AWstat工具"><a href="#二、AWstat工具" class="headerlink" title="二、AWstat工具"></a>二、AWstat工具</h1><p>Awstats是一个免费非常简洁而且强大有个性的网站日志分析工具。</p>
<h2 id="1、AWstat优势"><a href="#1、AWstat优势" class="headerlink" title="1、AWstat优势"></a>1、AWstat优势</h2><p>（1）界面友好：可以根据浏览器直接调用相关语言界面</p>
<p>（2）基于perl：解决了跨平台问题；分析日志直接支持apache格式</p>
<p>（3）效率比较高</p>
<p>（4）配置、定制方便</p>
<p>（5）提供了很多扩展参数统计功能</p>
<h3 id="2、AWstat运行原理"><a href="#2、AWstat运行原理" class="headerlink" title="2、AWstat运行原理"></a>2、AWstat运行原理</h3><p>apache将访问情况记录到日志中，AWstats每次执行更新时读取这些日志，分析日志数据；将结果存储到数据库中（纯文本）。最后AWstats提供一个cgi程序通过web页面显示数据库中所统计的数据。</p>
<h3 id="3、源码编译安装AWstat"><a href="#3、源码编译安装AWstat" class="headerlink" title="3、源码编译安装AWstat"></a>3、源码编译安装AWstat</h3><p>下载地址：<a href="http://www.awstats.org/#DOWNLOAD" target="_blank" rel="noopener">http://www.awstats.org/#DOWNLOAD</a></p>
<p>（1）源码编译安装AWstat</p>
<p><code>[root@localhost/usr/local]#tar xf awstats-7.6.tar.gz</code></p>
<p><code>[root@localhost/usr/local]#mv awstats-7.6 awstats</code></p>
<p><code>[root@localhost/usr/local]#cd awstats/</code></p>
<p><strong>注意：此处需在<code>/usr/local</code>目录下安装</strong></p>
<p>（2）修改文件权限</p>
<p><code>[root@localhost/usr/local/awstats]#chmod -R +x tools/*</code></p>
<p><code>[root@localhost/usr/local/awstats]#chmod -R +x wwwroot/cgi-bin/*</code></p>
<p><code>[root@localhost/usr/local/awstats]#chown -R root.root /usr/local/awstats</code></p>
<p>由于上传文件是不是以root身份，否则后面*.pl将无法运行。</p>
<p>（3）创建所需目录</p>
<p><code>[root@localhost/usr/local/awstats]#mkdir /etc/awstats</code> #存放站点日志分析的配置文件</p>
<p>（4）生成AWstats配置文件</p>
<p><code>[root@localhost/usr/local/awstats/tools]#./awstats_configure.pl</code></p>
<pre><code>----- AWStats awstats_configure 1.0 (build 20140126) (c) Laurent Destailleur -----
This tool will help you to configure AWStats to analyze statistics for
one web server. You can try to use it to let it do all that is possible
in AWStats setup, however following the step by step manual setup
documentation (docs/index.html) is often a better idea. Above all if:
- You are not an administrator user,
- You want to analyze downloaded log files without web server,
- You want to analyze mail or ftp log files instead of web log files,
- You need to analyze load balanced servers log files,
- You want to &#39;understand&#39; all possible ways to use AWStats...
Read the AWStats documentation (docs/index.html).

-----&gt; Running OS detected: Linux, BSD or Unix

-----&gt; Check for web server install

Enter full config file path of your Web server.
Example: /etc/httpd/httpd.conf
Example: /usr/local/apache2/conf/httpd.conf
Example: c:\Program files\apache group\apache\conf\httpd.conf
Config file path (&#39;none&#39; to skip web server setup):
&gt; /etc/httpd/conf/httpd.conf
- This file does not exists.
Config file path (&#39;none&#39; to skip web server setup):
&gt; /etc/httpd/conf/httpd.conf      #输入web服务配置文件的地址，如果是Nginx输入“none”

-----&gt; Check and complete web server config file &#39;/etc/httpd/conf/httpd.conf&#39;
  Add &#39;Alias /awstatsclasses &quot;/usr/local/awstats/wwwroot/classes/&quot;&#39;
  Add &#39;Alias /awstatscss &quot;/usr/local/awstats/wwwroot/css/&quot;&#39;
  Add &#39;Alias /awstatsicons &quot;/usr/local/awstats/wwwroot/icon/&quot;&#39;
  Add &#39;ScriptAlias /awstats/ &quot;/usr/local/awstats/wwwroot/cgi-bin/&quot;&#39;
  Add &#39;&lt;Directory&gt;&#39; directive
  AWStats directives added to Apache config file.

-----&gt; Update model config file &#39;/usr/local/awstats/wwwroot/cgi-bin/awstats.model.conf&#39;
  File awstats.model.conf updated.

-----&gt; Need to create a new config file ?
Do you want me to build a new AWStats config/profile
file (required if first install) [y/N] ? y  #是否创建一个新的配置文件

-----&gt; Define config file name to create
What is the name of your web site or profile analysis ?
Example: www.mysite.com
Example: demo
Your web site, virtual server or profile name:
&gt; www.test.com   #网站域名名称

-----&gt; Define config file path
In which directory do you plan to store your config file(s) ?
Default: /etc/awstats
Directory path to store config file(s) (Enter for default):      
&gt;     #配置文件存放在哪个位置，这里选择默认即可；回车

-----&gt; Create config file &#39;/etc/awstats/awstats.www.test.com.conf&#39;
 Config file /etc/awstats/awstats.www.test.com.conf created.

-----&gt; Restart Web server with &#39;/sbin/service httpd restart&#39;
Redirecting to /bin/systemctl restart httpd.service

-----&gt; Add update process inside a scheduler
Sorry, configure.pl does not support automatic add to cron yet.
You can do it manually by adding the following command to your cron:
/usr/local/awstats/wwwroot/cgi-bin/awstats.pl -update -config=www.test.com
Or if you have several config files and prefer having only one command:
/usr/local/awstats/tools/awstats_updateall.pl now
Press ENTER to continue...   
                #提示不能自动加入crontab任务，需要稍后自己添加，回车即可

A SIMPLE config file has been created: /etc/awstats/awstats.www.test.com.conf
You should have a look inside to check and change manually main parameters.
You can then manually update your statistics for &#39;www.test.com&#39; with command:
&gt; perl awstats.pl -update -config=www.test.com
You can also read your statistics for &#39;www.test.com&#39; with URL:
&gt; http://localhost/awstats/awstats.pl?config=www.test.com

Press ENTER to finish...  #提示配置文件创建完成，回车即可
</code></pre><p>（5）修改刚生成的配置文件</p>
<p><code>[root@localhost/etc/awstats]#vim awstats.www.test.com.conf</code></p>
<pre><code>50 LogFile=&quot;/var/log/httpd/access_log&quot;    

此选项的位置必须和http位置一致

 156 SiteDomain=&quot;www.test.com&quot;
此选项设置站点域名

 171 HostAliases=&quot;test.com www.test.com 127.0.0.1 localhost&quot;
此选项设置主机别名

 220 DirData=&quot;/var/lib/awstats&quot;
此选项设置存放日志数据的位置
</code></pre><p>（6）修改httpd.conf文件</p>
<p><code>[root@localhost/etc/awstats]#vim /etc/httpd/conf/httpd.conf</code></p>
<h4 id="如果apache是2-2版本如下格式"><a href="#如果apache是2-2版本如下格式" class="headerlink" title="如果apache是2.2版本如下格式"></a>如果apache是2.2版本如下格式</h4><pre><code>366 &lt;Directory &quot;/usr/local/awstats/wwwroot&quot;&gt;
367     Options None
368     AllowOverride None
369     Order allow,deny
370     Allow from all
371 &lt;/Directory&gt;
</code></pre><h4 id="如果apache是2-4版本如下格式"><a href="#如果apache是2-4版本如下格式" class="headerlink" title="如果apache是2.4版本如下格式"></a>如果apache是2.4版本如下格式</h4><pre><code>366 &lt;Directory &quot;/usr/local/awstats/wwwroot&quot;&gt;
367     Options None
368     AllowOverride None
369     Require all granted         
370 &lt;/Directory&gt;
</code></pre><p>上述根据自己的实际情况进行修改</p>
<p>（7）重启http服务</p>
<p><code>[root@localhost~]#systemctl restart httpd</code></p>
<p>（8）创建存放日志数据信息目录</p>
<p><code>[root@localhost/usr/local/awstats]#mkdir /var/lib/awstats</code> </p>
<p><code>[root@localhost~]#chmod 755 /var/lib/awstats/</code>#修改权限</p>
<p>（9）更新awstats数据库</p>
<p>语法：</p>
<pre><code>Syntax: awstats.pl -config=virtualhostname [options]
</code></pre><p><strong>注意：</strong></p>
<ul>
<li>配置文件 (awstats.virtualhostname.conf or awstats.conf) 必须在<code>/etc/awstats</code>,<code>/usr/local/etc/awstats</code>, <code>/etc</code> 或 same directory than awstats.pl script file.</li>
<li>如果AWSTATS_FORCE_CONFIG环境变量被定义，AWstat将使用定义环境变量作为配置值。</li>
</ul>
<p><code>[root@localhost~]#/usr/local/awstats/wwwroot/cgi-bin/awstats.pl -update -config=www.test.com</code></p>
<pre><code>Create/Update database for config &quot;/etc/awstats/awstats.www.test.com.conf&quot; by AWStats version 7.6 (build 20161204)
From data in log file &quot;/var/log/httpd/access_log&quot;...
Phase 1 : First bypass old records, searching new record...
Searching new records from beginning of log file...
Jumped lines in file: 0
Parsed lines in file: 0
 Found 0 dropped records,
 Found 0 comments,
 Found 0 blank records,
 Found 0 corrupted records,
 Found 0 old records,
 Found 0 new qualified records.
</code></pre><p>（10）测试</p>
<p><a href="http://192.168.4.65/awstats/awstats.pl?config=www.test.com" target="_blank" rel="noopener">http://192.168.4.65/awstats/awstats.pl?config=www.test.com</a></p>
<p><img src="http://owatlfstl.bkt.clouddn.com/2017-10-25_195954.jpg" alt=""></p>
<p><strong>小结：</strong></p>
<p>（1）AWstats数据库不能及时更新，如果想定时更新可以写计划任务。</p>
<p>（2）安装过程中可能会访问时出现403错误，可能是权限不够，看看<code>/var/lib/awstat1</code>目录权限</p>
<p>（3）AWstat工作时基于apache日志工作的，配置文件的日志目录与apache中的日志路径相同</p>
<p>（4）在生成配置文件时必须在<code>/usr/local/awstat</code>目录下创建，否则会报错找不到路径</p>
<p>如果配置多站点监控？<br>-</p>
<p>和上述配置的过程一样。</p>
<p><code>[root@localhost/usr/local/awstats/tools]#ls /etc/awstats/</code></p>
<pre><code>awstats.www.test2.com.conf  awstats.www.test.com.conf
</code></pre><h1 id="三、ASstats扩展"><a href="#三、ASstats扩展" class="headerlink" title="三、ASstats扩展"></a>三、ASstats扩展</h1><h2 id="1、ASstats默认是不显示访客的国家的，若果需要可以添加插件"><a href="#1、ASstats默认是不显示访客的国家的，若果需要可以添加插件" class="headerlink" title="1、ASstats默认是不显示访客的国家的，若果需要可以添加插件"></a>1、ASstats默认是不显示访客的国家的，若果需要可以添加插件</h2><p><a href="http://geolite.maxmind.com/download/geoip/database" target="_blank" rel="noopener">http://geolite.maxmind.com/download/geoip/database</a>  下载地址</p>
<p>GeoIP 是国家数据</p>
<p>GeoLiteCity 是城市数据</p>
<p>GeoIPASNum 是组织数据</p>
<p>（1）安装过程</p>
<p><code>[root@localhost~]#gunzip GeoIP.dat.gz</code></p>
<p><code>[root@localhost~]#gunzip GeoLiteCity.dat.gz</code></p>
<p><code>[root@localhost~]#mkdir /var/GeoIP</code></p>
<p><code>[root@localhost~]#mv  Geo* /var/GeoIP</code></p>
<p><code>[root@localhost~]#cd /var/GeoIP</code></p>
<p><code>[root@localhost/var/GerIP/GeoIP-1.4.8]#tar xf GeoIP-1.4.8.tar.gz</code></p>
<h3 id="编译安装GeoIP"><a href="#编译安装GeoIP" class="headerlink" title="编译安装GeoIP"></a>编译安装GeoIP</h3><p><code>[root@localhost/var/GerIP/GeoIP-1.4.8]#yum install -y zlib-devel</code></p>
<p><code>[root@localhost/var/GerIP/GeoIP-1.4.8]#./configure ;make &amp;&amp; make  install</code></p>
<h3 id="编译安装Geo-IP"><a href="#编译安装Geo-IP" class="headerlink" title="编译安装Geo-IP"></a>编译安装Geo-IP</h3><p><code>[root@localhost/var/geoip/Geo-IP-1.40]#yum install perl-ExtUtils-CBuilder perl-ExtUtils-MakeMaker</code></p>
<p><code>[root@localhost/var/geoip/Geo-IP-1.40]#perl Makefile.PL LIBS=&#39;-L/usr/local/lib&#39;</code></p>
<p><code>[root@localhost/var/geoip/Geo-IP-1.40]#make &amp;&amp; make install</code></p>
<h3 id="修改AWstats配置文件"><a href="#修改AWstats配置文件" class="headerlink" title="修改AWstats配置文件"></a>修改AWstats配置文件</h3><p><code>[root@localhost/var/geoip-city]#vim /etc/awstats/awstats.www.test.com.conf</code></p>
<pre><code>1460 LoadPlugin=&quot;geoip GEOIP_STANDARD /var/geoip/GeoIP.dat&quot;
1466 LoadPlugin=&quot;geoip_org_maxmind GEOIP_STANDARD /var/genip/GeoIPOrg.dat&quot;
1479 LoadPlugin=&quot;geoip_city_maxmind GEOIP_STANDARD /var/geoip/GeoIPCity.dat&quot;
</code></pre><h3 id="测试"><a href="#测试" class="headerlink" title="测试"></a>测试</h3><p>（2）中文乱码问题</p>
<p><code>[root@localhost~]#vim /etc/awstats/awstats.www.test.com.conf</code></p>
<pre><code>#LoadPlugin=&quot;decodeutfkeys&quot; #1300 行
LoadPlugin=&quot;decodeutfkeys&quot;
</code></pre><p>不过修改编码以后还会出错缺少perl的URI模块，下面是解决方法：</p>
<p><code>[root@localhost/usr/local/src]#tar xf URI-1.60.tar.gz</code> </p>
<p><code>[root@localhost/usr/local/src]#cd URI-1.60/</code></p>
<p><code>[root@localhost/usr/local/src/URI-1.60]#perl Makefile.PL</code></p>
<p><code>[root@localhost/usr/local/src/URI-1.60]#make &amp;&amp; make install</code></p>
<p><strong>小结：</strong></p>
<p>显示国家扩展模块安装时有顺序的</p>
<pre><code>GeoIP C库--&gt;Geo-IP perl库
</code></pre>
            </div>
            <hr/>

            
            <style>
    #reward {
        margin: 40px 0;
        text-align: center;
    }

    #reward .reward-link {
        font-size: 1.88rem;
    }

    #reward .btn-floating:hover {
        box-shadow: 0 6px 12px rgba(0, 0, 0, 0.2), 0 5px 15px rgba(0, 0, 0, 0.2);
    }

    #rewardModal {
        width: 320px;
        height: 350px;
    }

    #rewardModal .reward-title {
        margin: 15px auto;
        padding-bottom: 5px;
    }

    #rewardModal .modal-content {
        padding: 10px;
    }

    #rewardModal .close {
        position: absolute;
        right: 15px;
        top: 15px;
        color: rgba(0, 0, 0, 0.5);
        font-size: 1.3rem;
        line-height: 20px;
        cursor: pointer;
    }

    #rewardModal .reward-tabs {
        margin: 0 auto;
        width: 210px;
    }

    .reward-tabs .tabs {
        height: 38px;
        margin: 10px auto;
        padding-left: 0;
    }

    .reward-tabs .tabs .tab {
        height: 38px;
        line-height: 38px;
    }

    .reward-tabs .tab a {
        color: #fff;
        background-color: #ccc;
    }

    .reward-tabs .tab a:hover {
        color: #fff;
    }

    .reward-tabs .wechat-tab .active {
        color: #fff;
        background-color: #22AB38;
    }

    .reward-tabs .alipay-tab .active {
        color: #fff;
        background-color: #019FE8;
    }

    .reward-tabs .reward-img {
        width: 210px;
        height: 210px;
    }
</style>

<div id="reward">
    <a class="reward-link btn-floating btn-large waves-effect waves-light red">赏</a>

    <!-- Modal Structure -->
    <div id="rewardModal" class="modal">
        <div class="modal-content">
            <a class="close"><i class="fa fa-close"></i></a>
            <h4 class="reward-title">你的赏识是我前进的动力</h4>
            <div class="reward-content">
                <div class="reward-tabs">
                    <ul class="tabs">
                        <li class="tab wechat-tab waves-effect waves-light"><a class="active" href="#wechat">微信</a></li>
                        <li class="tab alipay-tab waves-effect waves-light"><a href="#alipay">支付宝</a></li>
                    </ul>
                    <div id="wechat">
                        <img src="/medias/reward/wechat.png" class="reward-img" alt="微信打赏二维码">
                    </div>
                    <div id="alipay">
                        <img src="/medias/reward/alipay.jpg" class="reward-img" alt="支付宝打赏二维码">
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    $(function () {
        $('#reward .reward-link').on('click', function () {
            $('#rewardModal').openModal();
        });

        $('#rewardModal .close').on('click', function () {
            $('#rewardModal').closeModal();
        });
    });
</script>
            

            <link rel="stylesheet" type="text/css" href="/libs/share/css/share.min.css">

<div id="article-share">
    
    <div class="social-share" data-disabled="qzone" data-wechat-qrcode-helper="<p>微信里点“发现”->“扫一扫”二维码便可查看分享。</p>"></div>
    
</div>

<script src="/libs/share/js/social-share.min.js"></script>

            <div class="reprint">
                <p>
                    <span class="reprint-tip">
                        <i class="fa fa-exclamation-circle"></i>&nbsp;&nbsp;转载请注明:
                    </span>
                    <a href="www.lmfe.org" class="b-link-green">Joah</a>
                    <i class="fa fa-angle-right fa-lg fa-fw text-color"></i>
                    <a href="/2017/11/28/Apache分析工具和日志管理工具/" class="b-link-green">Apache分析和日志管理工具</a>
                </p>
            </div>
        </div>
    </div>

    

    

    

    

    

    

<article id="prenext-posts" class="prev-next articles">
    <div class="row article-row">
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge left-badge text-color">
                <i class="fa fa-chevron-left"></i>&nbsp;上一篇</div>
            <div class="card">
                <a href="/2017/11/28/Nginx介绍/">
                    <div class="card-image">
                        
                        
                        <img src="/medias/featureimages/20.jpg" class="responsive-img" alt="Nginx介绍">
                        
                        <span class="card-title">Nginx介绍</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary">
Nginx是一款轻量级的Web 服务器/反向代理服务器及电子邮件（IMAP/POP3）代理服务器，并在一个BSD-like 协议下发行。其特点是占有内存少，并发能力强。
一、Nginx介绍
1、Nginx程序架构Nginx程序架构：mas</div>
                    <div class="publish-info">
                        <span class="publish-date">
                            <i class="fa fa-clock-o fa-fw icon-date"></i>2017-11-28
                        </span>
                        <span class="publish-author">
                            
                            <i class="fa fa-bookmark fa-fw icon-category"></i>
                            
                            <a href="/categories/常用服务/" class="post-category" target="_blank">
                                    常用服务
                                </a>
                            
                            
                        </span>
                    </div>
                </div>
                
                <div class="card-action article-tags">
                    
                    <a href="/tags/nginx/" target="_blank">
                        <span class="chip bg-color">nginx</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge right-badge text-color">
                下一篇&nbsp;<i class="fa fa-chevron-right"></i>
            </div>
            <div class="card">
                <a href="/2017/11/28/Nginx模块/">
                    <div class="card-image">
                        
                        
                        <img src="/medias/featureimages/16.jpg" class="responsive-img" alt="Nginx模块">
                        
                        <span class="card-title">Nginx模块</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary">一、ngx_http_fastcgi_module转发请求到FastCGI服务器，不支持php模块方式
（1）fastcgi_pass address
address 为后端的fastcgi server的地址可用
Syntax:    f</div>
                    <div class="publish-info">
                            <span class="publish-date">
                                <i class="fa fa-clock-o fa-fw icon-date"></i>2017-11-28
                            </span>
                        <span class="publish-author">
                            
                            <i class="fa fa-bookmark fa-fw icon-category"></i>
                            
                            <a href="/categories/常用服务/" class="post-category" target="_blank">
                                    常用服务
                                </a>
                            
                            
                        </span>
                    </div>
                </div>
                
                <div class="card-action article-tags">
                    
                    <a href="/tags/nginx/" target="_blank">
                        <span class="chip bg-color">nginx</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
    </div>
</article>
</div>


    

</main>


<footer class="page-footer bg-color">
    <div class="container row center-align">
        <div class="col s12 m8 l8 copy-right">

            
                &nbsp;<i class="fa fa-area-chart"></i>&nbsp;站点总字数:&nbsp;
                <span class="white-color">181.1k</span>
            

            
			
                <br>
                
                <span id="busuanzi_container_site_pv">
                    <i class="fa fa-heart-o"></i>
                    本站总访问量 <span id="busuanzi_value_site_pv" class="white-color"></span>
                </span>
                
                
                <span id="busuanzi_container_site_uv">
                    <i class="fa fa-users"></i>
                    次,&nbsp;访客数 <span id="busuanzi_value_site_uv" class="white-color"></span> 人.
                </span>
                
            
        </div>
        <div class="col s12 m4 l4 social-link social-statis">
    <a href="https://github.com/ergedan/" class="tooltipped" target="_blank" data-tooltip="访问我的GitHub" data-position="top" data-delay="50">
        <i class="fa fa-github"></i>
    </a>



    <a href="mailto:473823554@qq.com" class="tooltipped" target="_blank" data-tooltip="邮件联系我" data-position="top" data-delay="50">
        <i class="fa fa-envelope-open"></i>
    </a>



    <a href="tencent://AddContact/?fromId=50&fromSubId=1&subcmd=all&uin=473823554" class="tooltipped" data-tooltip="QQ联系我: 473823554" data-position="top" data-delay="50">
        <i class="fa fa-qq"></i>
    </a>



    <a href="/atom.xml" class="tooltipped" target="_blank" data-tooltip="RSS 订阅" data-position="top" data-delay="50">
        <i class="fa fa-rss"></i>
    </a>
</div>
    </div>
</footer>

<div class="progress-bar"></div>


<!-- 搜索遮罩框 -->
<div id="searchModal" class="modal">
    <div class="modal-content">
        <div class="search-header">
            <span class="title"><i class="fa fa-search"></i>&nbsp;&nbsp;搜索</span>
            <input type="search" id="searchInput" name="s" placeholder="请输入搜索的关键字"
                   class="search-input" autofocus="">
        </div>
        <div id="searchResult"></div>
    </div>
</div>

<script src="/js/search.js"></script>
<script type="text/javascript">
    searchFunc("/" + "search.xml", 'searchInput', 'searchResult');
</script>
<!-- 回到顶部按钮 -->
<div id="backTop" class="top-scroll">
    <a class="btn-floating btn-large waves-effect waves-light" href="#!">
        <i class="fa fa-angle-up"></i>
    </a>
</div>


<script src="/libs/materialize/js/materialize.min.js"></script>
<script src="/libs/masonry/masonry.pkgd.min.js"></script>
<script src="/libs/aos/aos.js"></script>
<script src="/libs/scrollprogress/scrollProgress.min.js"></script>
<script src="/libs/lightGallery/js/lightgallery-all.min.js"></script>
<script src="/js/matery.js"></script>

<!-- Global site tag (gtag.js) - Google Analytics -->




    <script async src="/libs/others/busuanzi.pure.mini.js"></script>


</body>
</html>