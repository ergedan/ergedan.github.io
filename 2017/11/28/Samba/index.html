<!DOCTYPE HTML>
<html lang="zh-CN">


<head>
    <meta charset="utf-8">
    <meta name="keywords" content="Samba, 运维小李">
    <meta name="description" content="Samba是在Linux和UNIX系统上实现SMB协议的一个免费软件，基于C/S架构。SMB（Server Messages Block，信息服务块）是一种在局域网上共享文件和打印机的一种通信协议，它为局域网内的不同计算机之间提供文件及打印">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="renderer" content="webkit|ie-stand|ie-comp">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="format-detection" content="telephone=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <title>Samba | 运维小李</title>
    <link rel="icon" type="image/png" href="/favicon.png">

    <link rel="stylesheet" type="text/css" href="/libs/awesome/css/font-awesome.min.css">
    <link rel="stylesheet" type="text/css" href="/libs/materialize/css/materialize.min.css">
    <link rel="stylesheet" type="text/css" href="/libs/aos/aos.css">
    <link rel="stylesheet" type="text/css" href="/libs/animate/animate.min.css">
    <link rel="stylesheet" type="text/css" href="/libs/lightGallery/css/lightgallery.min.css">
    <link rel="stylesheet" type="text/css" href="/css/matery.css">
    <link rel="stylesheet" type="text/css" href="/css/my.css">

    <script src="/libs/jquery/jquery-2.2.0.min.js"></script>
<link rel="stylesheet" href="/css/prism-tomorrow.css" type="text/css"></head>


<body>

<header class="navbar-fixed">
    <nav id="headNav" class="bg-color nav-transparent">
        <div id="navContainer" class="container">
            <div class="nav-wrapper">
                <div class="brand-logo">
                    <a href="/" class="waves-effect waves-light">
                        
                        <img src="/medias/logo.png" class="logo-img hide-on-small-only">
                        
                        <span class="logo-span">运维小李</span>
                    </a>
                </div>
                

<a href="#" data-activates="mobile-nav" class="button-collapse"><i class="fa fa-navicon"></i></a>
<ul class="right">
    
    <li class="hide-on-med-and-down">
        <a href="/" class="waves-effect waves-light">
            
            <i class="fa fa-home"></i>
            
            <span>首页</span>
        </a>
    </li>
    
    <li class="hide-on-med-and-down">
        <a href="/tags" class="waves-effect waves-light">
            
            <i class="fa fa-tags"></i>
            
            <span>标签</span>
        </a>
    </li>
    
    <li class="hide-on-med-and-down">
        <a href="/categories" class="waves-effect waves-light">
            
            <i class="fa fa-bookmark"></i>
            
            <span>分类</span>
        </a>
    </li>
    
    <li class="hide-on-med-and-down">
        <a href="/archives" class="waves-effect waves-light">
            
            <i class="fa fa-archive"></i>
            
            <span>归档</span>
        </a>
    </li>
    
    <li class="hide-on-med-and-down">
        <a href="/about" class="waves-effect waves-light">
            
            <i class="fa fa-user-circle-o"></i>
            
            <span>关于</span>
        </a>
    </li>
    
    <li class="hide-on-med-and-down">
        <a href="/friends" class="waves-effect waves-light">
            
            <i class="fa fa-address-book"></i>
            
            <span>友情链接</span>
        </a>
    </li>
    
    <li>
        <a id="toggleSearch" class="waves-effect waves-light">
            <i id="searchIcon" class="mdi-action-search" title="搜索"></i>
        </a>
    </li>

</ul>

<div class="side-nav" id="mobile-nav">

    <div class="mobile-head bg-color">
        
        <img src="/medias/logo.png" class="logo-img circle responsive-img">
        
        <div class="logo-name">运维小李</div>
        <div class="logo-desc">
            
            Never really desperate, only the lost of the soul.
            
        </div>
    </div>

    

    <ul class="menu-list mobile-menu-list">
        
        <li>
            <a href="/" class="waves-effect waves-light">
                
                <i class="fa fa-fw fa-home"></i>
                
                首页
            </a>
        </li>
        
        <li>
            <a href="/tags" class="waves-effect waves-light">
                
                <i class="fa fa-fw fa-tags"></i>
                
                标签
            </a>
        </li>
        
        <li>
            <a href="/categories" class="waves-effect waves-light">
                
                <i class="fa fa-fw fa-bookmark"></i>
                
                分类
            </a>
        </li>
        
        <li>
            <a href="/archives" class="waves-effect waves-light">
                
                <i class="fa fa-fw fa-archive"></i>
                
                归档
            </a>
        </li>
        
        <li>
            <a href="/about" class="waves-effect waves-light">
                
                <i class="fa fa-fw fa-user-circle-o"></i>
                
                关于
            </a>
        </li>
        
        <li>
            <a href="/friends" class="waves-effect waves-light">
                
                <i class="fa fa-fw fa-address-book"></i>
                
                友情链接
            </a>
        </li>
        
        
        <li><div class="divider"></div></li>
        <li>
            <a href="https://github.com/ergedan/" class="waves-effect waves-light" target="_blank">
                <i class="fa fa-github-square fa-fw"></i>fork me
            </a>
        </li>
        
    </ul>

    <div class="social-link">
    <a href="https://github.com/ergedan/" class="tooltipped" target="_blank" data-tooltip="访问我的GitHub" data-position="top" data-delay="50">
        <i class="fa fa-github"></i>
    </a>



    <a href="mailto:473823554@qq.com" class="tooltipped" target="_blank" data-tooltip="邮件联系我" data-position="top" data-delay="50">
        <i class="fa fa-envelope-open"></i>
    </a>



    <a href="tencent://AddContact/?fromId=50&fromSubId=1&subcmd=all&uin=473823554" class="tooltipped" data-tooltip="QQ联系我: 473823554" data-position="top" data-delay="50">
        <i class="fa fa-qq"></i>
    </a>



    <a href="/atom.xml" class="tooltipped" target="_blank" data-tooltip="RSS 订阅" data-position="top" data-delay="50">
        <i class="fa fa-rss"></i>
    </a>
</div>
</div>

            </div>
        </div>

        
        <style>
    .nav-transparent .github-corner {
        display: none !important;
    }

    .github-corner {
        position: absolute;
        z-index: 10;
        top: 0;
        right: 0;
        border: 0;
        transform: scale(1.1);
    }

    .github-corner svg {
        color: #0f9d58;
        fill: #fff;
        height: 64px;
        width: 64px;
    }

    .github-corner:hover .octo-arm {
        animation: a 0.56s ease-in-out;
    }

    .github-corner .octo-arm {
        animation: none;
    }

    @keyframes a {
        0%,
        to {
            transform: rotate(0);
        }
        20%,
        60% {
            transform: rotate(-25deg);
        }
        40%,
        80% {
            transform: rotate(10deg);
        }
    }
</style>

<a href="https://github.com/ergedan/" class="github-corner tooltipped hide-on-med-and-down" target="_blank"
   data-tooltip="fork me" data-position="left" data-delay="50">
    <svg viewBox="0 0 250 250" aria-hidden="true">
        <path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path>
        <path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2"
              fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path>
        <path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z"
              fill="currentColor" class="octo-body"></path>
    </svg>
</a>
        
    </nav>
</header>





<div class="bg-cover post-cover" style="background-image: url('/medias/featureimages/22.jpg')">
    <div class="container">
        <div class="row">
            <div class="col s12 m12 l12">
                <div class="brand">
                    <div class="description center-align post-title">
                        Samba
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>



<main class="container content">

    
    <!-- 文章内容详情 -->
<div id="artDetail">
    <div class="card">
        <div class="card-content article-info">
            <div class="row tag-cate">
                <div class="col s7">
                    
                    <div class="article-tag">
                        
                            <a href="/tags/samba/" target="_blank">
                                <span class="chip bg-color">samba</span>
                            </a>
                        
                    </div>
                    
                </div>
                <div class="col s5 right-align">
                    
                    <div class="post-cate">
                        <i class="fa fa-bookmark fa-fw icon-category"></i>
                        
                            <a href="/categories/文件管理/" class="post-category" target="_blank">
                                文件管理
                            </a>
                        
                            <a href="/categories/文件管理/Samba/" class="post-category" target="_blank">
                                Samba
                            </a>
                        
                    </div>
                    
                </div>
            </div>

            <div class="post-info">
                <div class="post-date info-break-policy">
                    <i class="fa fa-calendar-minus-o fa-fw"></i>发布日期:&nbsp;&nbsp;
                    2017-11-28
                </div>

                
                    
                    <div class="info-break-policy">
                        <i class="fa fa-file-word-o fa-fw"></i>文章字数:&nbsp;&nbsp;
                        2,581
                    </div>
                    

                    
                    <div class="info-break-policy">
                        <i class="fa fa-clock-o fa-fw"></i>阅读时长:&nbsp;&nbsp;
                        11 分
                    </div>
                    
                
				
				
                    <div id="busuanzi_container_page_pv" class="info-break-policy">
                        <i class="fa fa-eye fa-fw"></i>阅读次数:&nbsp;&nbsp;
                        <span id="busuanzi_value_page_pv"></span>
                    </div>
				
            </div>
        </div>
        <hr class="clearfix">
        <div class="card-content article-card-content">
            <div id="articleContent">
                <p>Samba是在Linux和UNIX系统上实现SMB协议的一个免费软件，基于C/S架构。SMB（Server Messages Block，信息服务块）是一种在局域网上共享文件和打印机的一种通信协议，它为局域网内的不同计算机之间提供文件及打印机等资源的共享服务。SMB协议是客户机/服务器型协议，客户机通过该协议可以访问服务器上的共享文件系统、打印机及其他资源。通过设置“NetBIOS over TCP/IP”使得Samba不但能与局域网络主机分享资源，还能与全世界的电脑分享资源。</p>
<h1 id="一、SAMAB基本概念"><a href="#一、SAMAB基本概念" class="headerlink" title="一、SAMAB基本概念"></a>一、SAMAB基本概念</h1><h2 id="1、SMB的基本功能"><a href="#1、SMB的基本功能" class="headerlink" title="1、SMB的基本功能"></a>1、SMB的基本功能</h2><ul>
<li>共享文件和打印，实现在线编辑</li>
<li>实现登录SMB用户的身份认证</li>
<li>可以进行NetBIOS名称解析</li>
<li>外围设备共享</li>
</ul>
<h2 id="2、SAMAB服务基于协议"><a href="#2、SAMAB服务基于协议" class="headerlink" title="2、SAMAB服务基于协议"></a>2、SAMAB服务基于协议</h2><h3 id="（1）、NetBIOS协议"><a href="#（1）、NetBIOS协议" class="headerlink" title="（1）、NetBIOS协议"></a>（1）、NetBIOS协议</h3><p>NETBIOS（Network Basic Input/Output System）协议是由IBM公司开发，主要用于数十台计算机的小型局域网。该协议是一种在局域网上的程序可以使用的应用程序编程接口（API），为程序提供了请求低级服务的统一的命令集，作用是为了给局域网提供网络以及其他特殊功能。系统可以利用WINS服务、广播及Lmhost文件等多种模式将NetBIOS名-——特指基于NETBIOS协议获得计算机名称——解析为相应IP地址，实现信息通讯，所以在局域网内部使用NetBIOS协议可以方便地实现消息通信及资源的共享。</p>
<h3 id="NetBIOS特点"><a href="#NetBIOS特点" class="headerlink" title="NetBIOS特点"></a>NetBIOS特点</h3><ul>
<li>占用系统资源少</li>
<li>传输效率高</li>
</ul>
<h3 id="（2）CIFS协议"><a href="#（2）CIFS协议" class="headerlink" title="（2）CIFS协议"></a>（2）CIFS协议</h3><p>CIFS 是一个新提出的协议，它使程序可以访问远程Internet计算机上的文件并要求此计算机提供服务。CIFS 使用客户/服务器模式。客户程序请求远在服务器上的服务器程序为它提供服务。服务器获得请求并返回响应。CIFS是公共的或开放的SMB协议版本，并由Microsoft使用。SMB协议在局域网上用于服务器文件访问和打印的协议。像SMB协议一样，CIFS在高层运行，而不像TCP/IP协议那样运行在底层。CIFS可以看做是应用程序协议如文件传输协议和超文本传输协议的一个实现。</p>
<h3 id="CIFS协议功能"><a href="#CIFS协议功能" class="headerlink" title="CIFS协议功能"></a>CIFS协议功能</h3><ul>
<li>访问服务器本地文件并读写这些文件</li>
<li>与其他用户一起共享一些文件</li>
<li>在短线时自动回复与网络的连接</li>
<li>使用统一码文件名</li>
</ul>
<h3 id="（3）smb协议"><a href="#（3）smb协议" class="headerlink" title="（3）smb协议"></a>（3）smb协议</h3><p>SMB(全称是Server Message Block)是一个协议名，它能被用于Web连接和客户端与服务器之间的信息沟通。SMB最初是IBM的贝瑞·费根鲍姆（Barry Feigenbaum）研制的，其目的是将DOS操作系统中的本地文件接口“中断13”改造为网络文件系统。</p>
<h2 id="3、SAMBA服务文件介绍"><a href="#3、SAMBA服务文件介绍" class="headerlink" title="3、SAMBA服务文件介绍"></a>3、SAMBA服务文件介绍</h2><h3 id="（1）samba相关包介绍"><a href="#（1）samba相关包介绍" class="headerlink" title="（1）samba相关包介绍"></a>（1）samba相关包介绍</h3><table>
<thead>
<tr>
<th>包名</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>samba</td>
<td>提供smb服务</td>
</tr>
<tr>
<td>samba-client</td>
<td>提供客户端工具</td>
</tr>
<tr>
<td>samba-common</td>
<td>通用软件</td>
</tr>
<tr>
<td>cifs-utils</td>
<td>smb客户端工具</td>
</tr>
<tr>
<td>samba-winbind</td>
<td>和AD相关的包</td>
</tr>
</tbody>
</table>
<h3 id="（2）主配置文件-etc-samba-smb-conf"><a href="#（2）主配置文件-etc-samba-smb-conf" class="headerlink" title="（2）主配置文件/etc/samba/smb.conf"></a>（2）主配置文件<code>/etc/samba/smb.conf</code></h3><p>sbm.conf继承了.ini（initialization）文件格式，用[]分成不同的部分。</p>
<p><strong>配置文件分为类</strong></p>
<ul>
<li>[global]：服务器通过或全局设置的部分</li>
<li>[homes]：用户的家目录共享</li>
<li>[printers]：定义打印机资源和服务</li>
<li>[SHARENAME]：自定义共享目录配置</li>
</ul>
<p><strong>配置文件宏定义</strong></p>
<table>
<thead>
<tr>
<th>选项</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>%m</td>
<td>客户端主机的NetBIOS名</td>
</tr>
<tr>
<td>%M</td>
<td>客户端的FQDN</td>
</tr>
<tr>
<td>%H</td>
<td>当前用户家目录路径</td>
</tr>
<tr>
<td>%U</td>
<td>当前用户用户名</td>
</tr>
<tr>
<td>%g</td>
<td>当前用户所属组</td>
</tr>
<tr>
<td>%h</td>
<td>samba服务器的主机名</td>
</tr>
<tr>
<td>%L</td>
<td>samba服务器的NetBIOS</td>
</tr>
<tr>
<td>%I</td>
<td>客户端主机的IP</td>
</tr>
<tr>
<td>%T</td>
<td>当前日期和时间</td>
</tr>
<tr>
<td>%S</td>
<td>可登录的用户名</td>
</tr>
</tbody>
</table>
<p><strong>配置文件选项</strong></p>
<table>
<thead>
<tr>
<th>选项</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>workgroup</td>
<td>指定工作组名称</td>
</tr>
<tr>
<td>server string</td>
<td>主机注释信息</td>
</tr>
<tr>
<td>netbios name</td>
<td>指定NetBIOS名</td>
</tr>
<tr>
<td>interface</td>
<td>指定服务监听的接口和IP </td>
</tr>
<tr>
<td>host allow</td>
<td>指定允许指定主机访问，如多个主机可以网段，离散可以使用“，”、空格或tab分离；或使用主机名；默允许所有主机访问。示例192.168.4.</td>
</tr>
<tr>
<td>config file=/PAHT/TO/SOMEFIEL/%U</td>
<td>用户独立的配置文件</td>
</tr>
<tr>
<td>log file=/var/log/samba/log.%m</td>
<td>不同主机采用不同日志</td>
</tr>
<tr>
<td>max log size</td>
<td>日志文件大小，单位为KB</td>
</tr>
<tr>
<td>log level</td>
<td>设置日志级别</td>
</tr>
<tr>
<td>comment</td>
<td>注释信息</td>
</tr>
<tr>
<td>path</td>
<td>所共享的目录路径</td>
</tr>
<tr>
<td>public = {yes或no}</td>
<td>能否被guest访问的共享，默认为no</td>
</tr>
<tr>
<td>guest ok = {yes或no}</td>
<td>是否允许来宾账号访问</td>
</tr>
<tr>
<td>writable = {yes或no}</td>
<td>是否可读写</td>
</tr>
<tr>
<td>read only = {yes或no}</td>
<td>是否只读，如果与writeable设置冲突，放在后面的设置生效</td>
</tr>
<tr>
<td>write list</td>
<td>指定多个用户是否可写，格式：@GROUP_NAME、+GROUP_NAME或使用“，”分隔，如设置writable = no 列表中的用户或组可读写，不在列表中的用户只读</td>
</tr>
<tr>
<td>vaild users</td>
<td>特定用户才能访问此共享，如果设置为空，将允许所有用户；用户名之间使用空格分隔</td>
</tr>
<tr>
<td>browsable = {yes或no}</td>
<td>是否允许所有用户列浏览此共享，默认为yes</td>
</tr>
<tr>
<td>create mask</td>
<td>修改上传权限</td>
</tr>
</tbody>
</table>
<p><strong>注意：如果是某个用户对目录有权限，此用户必须有目录权限和共享权限的交集。</strong></p>
<p> 服务脚本：<br>    /etc/rc.d/init.d/nmb<br>    /etc/rc.d/init.d/smb</p>
<h2 id="4、管理命令"><a href="#4、管理命令" class="headerlink" title="4、管理命令"></a>4、管理命令</h2><h3 id="（1）testparm：检查smb-conf文件是否正确"><a href="#（1）testparm：检查smb-conf文件是否正确" class="headerlink" title="（1）testparm：检查smb.conf文件是否正确"></a>（1）testparm：检查smb.conf文件是否正确</h3><p>格式：</p>
<pre><code>testparm [-s] {config filename} [hostname hostIP]
</code></pre><h3 id="（2）smbclient-连接SMB-CIFS资源的命令"><a href="#（2）smbclient-连接SMB-CIFS资源的命令" class="headerlink" title="（2）smbclient 连接SMB/CIFS资源的命令"></a>（2）smbclient 连接SMB/CIFS资源的命令</h3><table>
<thead>
<tr>
<th>选项</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>-I</td>
<td>指定服务器的IP地址；</td>
</tr>
<tr>
<td>-L</td>
<td>显示服务器端所分享出来的所有资源；</td>
</tr>
<tr>
<td>-n</td>
<td>指定用户端所要使用的NetBIOS名称；</td>
</tr>
<tr>
<td>-N</td>
<td>不用询问密码；</td>
</tr>
<tr>
<td>-p</td>
<td>指定服务器端TCP连接端口编号； </td>
</tr>
<tr>
<td>-T</td>
<td>备份服务器端分享的全部文件，并打包成tar格式的文件；</td>
</tr>
<tr>
<td>-U&lt;用户名称&gt;</td>
<td>指定用户名称； </td>
</tr>
<tr>
<td>-w&lt;工作群组&gt;</td>
<td>指定工作群组名称。</td>
</tr>
</tbody>
</table>
<h3 id="（3）mount-cifs依赖于-cifs-utils包；挂载工具"><a href="#（3）mount-cifs依赖于-cifs-utils包；挂载工具" class="headerlink" title="（3）mount.cifs依赖于 cifs-utils包；挂载工具"></a>（3）mount.cifs依赖于 cifs-utils包；挂载工具</h3><h3 id="（4）smbpasswd-设置smb用户密码"><a href="#（4）smbpasswd-设置smb用户密码" class="headerlink" title="（4）smbpasswd 设置smb用户密码"></a>（4）smbpasswd 设置smb用户密码</h3><table>
<thead>
<tr>
<th>选项</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>-a</td>
<td>向smbpasswd文件中添加用户； </td>
</tr>
<tr>
<td>-c</td>
<td>指定samba的配置文件；</td>
</tr>
<tr>
<td>-x</td>
<td>从smbpasswd文件中删除用户；</td>
</tr>
<tr>
<td>-d</td>
<td>在smbpasswd文件中禁用指定的用户；</td>
</tr>
<tr>
<td>-e</td>
<td>在smbpasswd文件中激活指定的用户；</td>
</tr>
<tr>
<td>-n</td>
<td>将指定的用户的密码置空。</td>
</tr>
</tbody>
</table>
<p>密码文件存在在<code>/var/lib/samba/private/passdb.tdb</code></p>
<h3 id="（5）pdbedit"><a href="#（5）pdbedit" class="headerlink" title="（5）pdbedit"></a>（5）pdbedit</h3><table>
<thead>
<tr>
<th>选项</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>-a username</td>
<td>新建Samba账户。</td>
</tr>
<tr>
<td>-x username</td>
<td>删除Samba账户。</td>
</tr>
<tr>
<td>-L</td>
<td>列出Samba用户列表，读取`/var/lib/samba/private/passdb.tdb数据库文件。</td>
</tr>
<tr>
<td>-Lv</td>
<td>列出Samba用户列表的详细信息。</td>
</tr>
<tr>
<td>-c “[D]” –u username</td>
<td>暂停该Samba用户的账号。</td>
</tr>
<tr>
<td>-c “[]” –u username</td>
<td>恢复该Samba用户的账号。</td>
</tr>
</tbody>
</table>
<h3 id="（6）cifscreds-管理NTLM在内核密钥环中"><a href="#（6）cifscreds-管理NTLM在内核密钥环中" class="headerlink" title="（6）cifscreds 管理NTLM在内核密钥环中"></a>（6）cifscreds 管理NTLM在内核密钥环中</h3><pre><code>add：把指定用户的用户名和密码加入内核密钥环
</code></pre><h1 id="二、实现共享"><a href="#二、实现共享" class="headerlink" title="二、实现共享"></a>二、实现共享</h1><h2 id="（1）实现linux为客户端，windows为服务器端共享"><a href="#（1）实现linux为客户端，windows为服务器端共享" class="headerlink" title="（1）实现linux为客户端，windows为服务器端共享"></a>（1）实现linux为客户端，windows为服务器端共享</h2><p>在windows系统上创建一个共享目录</p>
<p>选中目录–&gt;右击点属性–&gt;共享</p>
<p><img src="http://owatlfstl.bkt.clouddn.com/2017-10-18_104753.jpg" alt=""></p>
<p>点击图中的用户可以设置权限</p>
<p>在linux客户端查看</p>
<p><code>[root@localhost ~]# smbclient -L 192.168.4.1 -U joah%PASSWORD</code></p>
<p><img src="http://owatlfstl.bkt.clouddn.com/2017-10-18_105307.jpg" alt=""></p>
<p><code>[root@localhost ~]# smbclient //192.168.4.1/linuxclient -U joah</code></p>
<p><img src="http://owatlfstl.bkt.clouddn.com/2017-10-18_105624.jpg" alt=""></p>
<p>挂载此目录</p>
<p>[root@localhost ~]# mount //192.168.4.1/linuxclient -o username=joah,password=PASSWORD /mnt/samba/</p>
<h2 id="（2）实现linux作服务器端，windows作客户端共享文件"><a href="#（2）实现linux作服务器端，windows作客户端共享文件" class="headerlink" title="（2）实现linux作服务器端，windows作客户端共享文件"></a>（2）实现linux作服务器端，windows作客户端共享文件</h2><p>创建smb账号</p>
<p><code>[root@localhost ~]# useradd -r smb1</code><br><code>[root@localhost ~]# useradd -r smb2</code><br><code>[root@localhost ~]# useradd -r smb2</code></p>
<p>设置smb账号密码</p>
<p><code>[root@localhost ~]# smbpasswd -a smb1</code><br><code>[root@localhost ~]# smbpasswd -a smb2</code><br><code>[root@localhost ~]# smbpasswd -a smb3</code></p>
<p>使用命令查看</p>
<p><code>[root@localhost ~]# pdbedit -L</code></p>
<pre><code>smb1:496:
smb3:494:
smb2:495:
</code></pre><p>创建共享目录</p>
<p><code>[root@localhost ~]# vim /etc/samba/smb.conf</code></p>
<pre><code>[sharewin]
        comment = linux share
        path = /app/smbshare
</code></pre><p><img src="http://owatlfstl.bkt.clouddn.com/2017-10-18_112436.jpg" alt=""></p>
<p>弹出对话框输入上述账户和密码即可登录</p>
<h2 id="（3）linux中实现不同用户权限访问共享目录"><a href="#（3）linux中实现不同用户权限访问共享目录" class="headerlink" title="（3）linux中实现不同用户权限访问共享目录"></a>（3）linux中实现不同用户权限访问共享目录</h2><p>###创建共享目录</p>
<p><code>[root@localhost ~]# mkdir /app/share{1,2,3}</code><br><code>[root@localhost ~]# chmod 777 /app/share{1,2,3}</code>   并设置目录权限</p>
<h3 id="编辑配置文件"><a href="#编辑配置文件" class="headerlink" title="编辑配置文件"></a>编辑配置文件</h3><p><code>[root@localhost ~]# vim /etc/samba/smb.conf</code>在全部设置下添加如下一行内容</p>
<pre><code>    config file = /etc/samba/conf.d/%U
</code></pre><h3 id="创建每个用户的配置文件"><a href="#创建每个用户的配置文件" class="headerlink" title="创建每个用户的配置文件"></a>创建每个用户的配置文件</h3><p><code>[root@localhost ~]# mkdir /etc/samba/conf.d</code>   #创建指定配置文件存放位置</p>
<p><code>[root@localhost conf.d]# vim smb1</code></p>
<pre><code>[share]
comment = share1
path = /app/share1
writeable = yes
</code></pre><p><code>[root@localhost conf.d]# vim smb2</code></p>
<pre><code>[share]
comment = share2
path = /app/share2
</code></pre><p><code>[root@localhost conf.d]# vim smb3</code></p>
<pre><code>[share]
comment = share3
path = /app/share3
</code></pre><h3 id="重启服务测试"><a href="#重启服务测试" class="headerlink" title="重启服务测试"></a>重启服务测试</h3><p><code>[root@localhost conf.d]# service nmb restart ;service smb restart</code></p>
<p>在另一外linux主机上测试</p>
<p><code>[root@localhost ~]# smbclient -L //192.168.4.55 -U smb1%123456</code></p>
<p><code>[root@localhost ~]# smbclient //192.168.4.55/share -U smb1%magedu</code></p>
<h3 id="挂载共享目录在本地"><a href="#挂载共享目录在本地" class="headerlink" title="挂载共享目录在本地"></a>挂载共享目录在本地</h3><p><code>[root@localhost smb]# mount //192.168.4.55/share /mnt/smb/ -o username=smb1,password=123456</code></p>
<h3 id="实现开机自动挂载"><a href="#实现开机自动挂载" class="headerlink" title="实现开机自动挂载"></a>实现开机自动挂载</h3><p><code>[root@localhost smb]# vim /etc/fstab</code></p>
<pre><code>//192.168.4.55/share    /mnt/smb                cifs    username=smb1,password=magedu   0 0
</code></pre><p>如果我们这样挂载的话，密码直接暴露出来，显然不安装，我们可以将用户和密码写到一个配置文件中</p>
<p><code>[root@localhost smb]# vim /etc/samba/userpasswd</code></p>
<pre><code>username=smb1
password=123456
</code></pre><p><code>[root@localhost ~]# chmod 600 /etc/samba/userpasswd</code>  #修改文件权限</p>
<p><code>[root@localhost ~]# vim /etc/fstab</code></p>
<pre><code>//192.168.4.55/share    /mnt/smb                cifs    credentials=/etc/samba/userpasswd       0 0
</code></pre><p><code>[root@localhost ~]# mount -a</code>  #使挂载生效</p>
<p><code>[root@localhost ~]# df</code></p>
<pre><code>Filesystem           1K-blocks    Used Available Use% Mounted on
/dev/sda2             50264772 1632864  46071908   4% /
tmpfs                   502056       0    502056   0% /dev/shm
/dev/sda3             50264772   89224  47615548   1% /app
/dev/sda1               487652   35604    426448   8% /boot
/dev/sr0               3878870 3878870         0 100% /media/cdrom
//192.168.4.55/share  50264772   53092  47651680   1% /mnt/smb  #挂载成功
</code></pre><h2 id="（4）实现多用户挂载（CentOS-7中可以启用这种方法）"><a href="#（4）实现多用户挂载（CentOS-7中可以启用这种方法）" class="headerlink" title="（4）实现多用户挂载（CentOS 7中可以启用这种方法）"></a>（4）实现多用户挂载（CentOS 7中可以启用这种方法）</h2><h3 id="修改配置文件"><a href="#修改配置文件" class="headerlink" title="修改配置文件"></a>修改配置文件</h3><p><code>[root@localhost ~]# vim /etc/samba/smb.conf</code></p>
<pre><code>[share]
        comment = sharedirectory
        path = /app/sharedir
        write list = smb1   #设置只有smb1用户具有写权限
</code></pre><h3 id="创建共享目录并赋予权限"><a href="#创建共享目录并赋予权限" class="headerlink" title="创建共享目录并赋予权限"></a>创建共享目录并赋予权限</h3><p><code>[root@localhost ~]# mkdir /app/sharedir</code><br><code>[root@localhost ~]# chmod 777 /app/sharedir</code></p>
<h3 id="在客户端创建与服务器端相同的账号"><a href="#在客户端创建与服务器端相同的账号" class="headerlink" title="在客户端创建与服务器端相同的账号"></a>在客户端创建与服务器端相同的账号</h3><p><strong>注意：客户端与服务器端必须有相同的用户。</strong></p>
<p><code>[root@localhost ~]# useradd smb1</code></p>
<p><code>[root@localhost ~]# useradd smb2</code></p>
<p><code>[root@localhost ~]# useradd smb3</code></p>
<h3 id="使用smb3用户挂载目录"><a href="#使用smb3用户挂载目录" class="headerlink" title="使用smb3用户挂载目录"></a>使用smb3用户挂载目录</h3><p><code>[root@localhost ~]# vim /etc/samba/userpasswd</code></p>
<pre><code>username=smb3
password=123456
</code></pre><h3 id="修改-etc-fstab文件"><a href="#修改-etc-fstab文件" class="headerlink" title="修改/etc/fstab文件"></a>修改<code>/etc/fstab</code>文件</h3><p><code>[root@localhost ~]# vim /etc/fstab</code></p>
<pre><code>//192.168.4.55/share    /mnt/smb                cifs    multiuser,credentials=/etc/samba/userpasswd     0 0


//192.168.4.55/share    /mnt/smb                cifs    credentials=/etc/samba/userpasswd,multiuser     0 0



credentials：用于指定包含挂载用户信息文件
multiuser：用于指定使用多用户挂载
</code></pre><p><code>[root@localhost ~]# mount -a</code>  #使挂载生效</p>
<h3 id="测试是否可以切换到smb1有写权限"><a href="#测试是否可以切换到smb1有写权限" class="headerlink" title="测试是否可以切换到smb1有写权限"></a>测试是否可以切换到smb1有写权限</h3><p><code>[root@localhost/mnt/smb]#su - smb1</code><br><code>[smb1@localhost~]$cifscreds add 192.168.4.55</code></p>
<pre><code>Password: 
</code></pre><p><code>[smb1@localhost~]$ls /mnt/smb/</code></p>
<pre><code>anaconda-ks.cfg  xx
</code></pre>
            </div>
            <hr/>

            

            <link rel="stylesheet" type="text/css" href="/libs/share/css/share.min.css">

<div id="article-share">
    
    <div class="social-share" data-disabled="qzone" data-wechat-qrcode-helper="<p>微信里点“发现”->“扫一扫”二维码便可查看分享。</p>"></div>
    
</div>

<script src="/libs/share/js/social-share.min.js"></script>

            <div class="reprint">
                <p>
                    <span class="reprint-tip">
                        <i class="fa fa-exclamation-circle"></i>&nbsp;&nbsp;转载请注明:
                    </span>
                    <a href="www.lmfe.org" class="b-link-green">运维小李</a>
                    <i class="fa fa-angle-right fa-lg fa-fw text-color"></i>
                    <a href="/2017/11/28/Samba/" class="b-link-green">Samba</a>
                </p>
            </div>
        </div>
    </div>

    
        <link rel="stylesheet" href="/libs/gitalk/gitalk.css">
<link rel="stylesheet" href="/css/my-gitalk.css">

<div class="card gitalk-card" data-aos="fade-up">
    <div id="gitalk-container" class="card-content"></div>
</div>

<script src="/libs/gitalk/gitalk.min.js"></script>
<script>
    let gitalk = new Gitalk({
        clientID: '',
        clientSecret: '',
        repo: '',
        owner: '',
        admin: null,
        id: '2017-11-28T00-00-00',
        distractionFreeMode: false  // Facebook-like distraction free mode
    });

    gitalk.render('gitalk-container');
</script>
    

    
        <link rel="stylesheet" href="/libs/gitment/gitment-default.css">
<link rel="stylesheet" href="/css/gitment.css">

<div class="gitment-card card" data-aos="fade-up">
    <div id="gitment-content" class="card-content"></div>
</div>

<script src="/libs/gitment/gitment.js"></script>
<script>
var gitment = new Gitment({
    id: 'Tue Nov 28 2017 00:00:00 GMT+0800',
    owner: '',
    repo: '',
    oauth: {
        client_id: '',
        client_secret: ''
    }
});

gitment.render('gitment-content');
</script>
    

    

    

    

    

<article id="prenext-posts" class="prev-next articles">
    <div class="row article-row">
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge left-badge text-color">
                <i class="fa fa-chevron-left"></i>&nbsp;上一篇</div>
            <div class="card">
                <a href="/2017/11/28/SSH简单介绍/">
                    <div class="card-image">
                        
                        
                        <img src="/medias/featureimages/9.jpg" class="responsive-img" alt="SSH简单介绍">
                        
                        <span class="card-title">SSH简单介绍</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary">一、SSH基本介绍1、含义：
    SSH 为 Secure Shell 的缩写，由 IETF 的网络小组（Network Working Group）所制定；SSH 为建立在应用层基础上的安全协议。SSH 是目前较可靠，专为远程登录会话</div>
                    <div class="publish-info">
                        <span class="publish-date">
                            <i class="fa fa-clock-o fa-fw icon-date"></i>2017-11-28
                        </span>
                        <span class="publish-author">
                            
                            <i class="fa fa-bookmark fa-fw icon-category"></i>
                            
                            <a href="/categories/服务/" class="post-category" target="_blank">
                                    服务
                                </a>
                            
                            <a href="/categories/服务/SSH/" class="post-category" target="_blank">
                                    SSH
                                </a>
                            
                            <a href="/categories/服务/SSH/SSH简单介绍/" class="post-category" target="_blank">
                                    SSH简单介绍
                                </a>
                            
                            
                        </span>
                    </div>
                </div>
                
                <div class="card-action article-tags">
                    
                    <a href="/tags/ssh/" target="_blank">
                        <span class="chip bg-color">ssh</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge right-badge text-color">
                下一篇&nbsp;<i class="fa fa-chevron-right"></i>
            </div>
            <div class="card">
                <a href="/2017/11/28/TCP_wrappers/">
                    <div class="card-image">
                        
                        
                        <img src="/medias/featureimages/6.jpg" class="responsive-img" alt="TCP_wrappers">
                        
                        <span class="card-title">TCP_wrappers</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary">tcp_wrappers1、概念Transmission Control Protocol (TCP) Wrappers 为由 inetd 生成的服务提供了增强的安全性。TCP Wrappers 是一种对使用 /etc/inetd.sec </div>
                    <div class="publish-info">
                            <span class="publish-date">
                                <i class="fa fa-clock-o fa-fw icon-date"></i>2017-11-28
                            </span>
                        <span class="publish-author">
                            
                            <i class="fa fa-bookmark fa-fw icon-category"></i>
                            
                            <a href="/categories/安全/" class="post-category" target="_blank">
                                    安全
                                </a>
                            
                            <a href="/categories/安全/TCP-wrappers/" class="post-category" target="_blank">
                                    TCP_wrappers
                                </a>
                            
                            
                        </span>
                    </div>
                </div>
                
                <div class="card-action article-tags">
                    
                    <a href="/tags/tcp-wrappers/" target="_blank">
                        <span class="chip bg-color">tcp_wrappers</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
    </div>
</article>
</div>


    

</main>


<footer class="page-footer bg-color">
    <div class="container row center-align">
        <div class="col s12 m8 l8 copy-right">
            本站由&copy;<a href="https://blinkfox.github.io/" target="_blank">Blinkfox</a>基于
            <a href="https://hexo.io/" target="_blank">Hexo</a> 的
            <a href="https://github.com/blinkfox/hexo-theme-matery" target="_blank">hexo-theme-matery</a>主题搭建.

            
                &nbsp;<i class="fa fa-area-chart"></i>&nbsp;站点总字数:&nbsp;
                <span class="white-color">178.2k</span>
            

            
			
                <br>
                
                <span id="busuanzi_container_site_pv">
                    <i class="fa fa-heart-o"></i>
                    本站总访问量 <span id="busuanzi_value_site_pv" class="white-color"></span>
                </span>
                
                
                <span id="busuanzi_container_site_uv">
                    <i class="fa fa-users"></i>
                    次,&nbsp;访客数 <span id="busuanzi_value_site_uv" class="white-color"></span> 人.
                </span>
                
            
        </div>
        <div class="col s12 m4 l4 social-link social-statis">
    <a href="https://github.com/ergedan/" class="tooltipped" target="_blank" data-tooltip="访问我的GitHub" data-position="top" data-delay="50">
        <i class="fa fa-github"></i>
    </a>



    <a href="mailto:473823554@qq.com" class="tooltipped" target="_blank" data-tooltip="邮件联系我" data-position="top" data-delay="50">
        <i class="fa fa-envelope-open"></i>
    </a>



    <a href="tencent://AddContact/?fromId=50&fromSubId=1&subcmd=all&uin=473823554" class="tooltipped" data-tooltip="QQ联系我: 473823554" data-position="top" data-delay="50">
        <i class="fa fa-qq"></i>
    </a>



    <a href="/atom.xml" class="tooltipped" target="_blank" data-tooltip="RSS 订阅" data-position="top" data-delay="50">
        <i class="fa fa-rss"></i>
    </a>
</div>
    </div>
</footer>

<div class="progress-bar"></div>


<!-- 搜索遮罩框 -->
<div id="searchModal" class="modal">
    <div class="modal-content">
        <div class="search-header">
            <span class="title"><i class="fa fa-search"></i>&nbsp;&nbsp;搜索</span>
            <input type="search" id="searchInput" name="s" placeholder="请输入搜索的关键字"
                   class="search-input" autofocus="">
        </div>
        <div id="searchResult"></div>
    </div>
</div>

<script src="/js/search.js"></script>
<script type="text/javascript">
    searchFunc("/" + "search.xml", 'searchInput', 'searchResult');
</script>
<!-- 回到顶部按钮 -->
<div id="backTop" class="top-scroll">
    <a class="btn-floating btn-large waves-effect waves-light" href="#!">
        <i class="fa fa-angle-up"></i>
    </a>
</div>


<script src="/libs/materialize/js/materialize.min.js"></script>
<script src="/libs/masonry/masonry.pkgd.min.js"></script>
<script src="/libs/aos/aos.js"></script>
<script src="/libs/scrollprogress/scrollProgress.min.js"></script>
<script src="/libs/lightGallery/js/lightgallery-all.min.js"></script>
<script src="/js/matery.js"></script>

<!-- Global site tag (gtag.js) - Google Analytics -->




    <script async src="/libs/others/busuanzi.pure.mini.js"></script>


</body>
</html>